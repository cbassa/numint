// Lunar l and r series
struct coeff_lr {
  int nd,nm,nm1,nf;
  double sa,ca;
} clr[]={
  { 0, 0, 1, 0,   6288774.0, -20905355.0},
  { 2, 0,-1, 0,   1274027.0,  -3699111.0},
  { 2, 0, 0, 0,    658314.0,  -2955968.0},
  { 0, 0, 2, 0,    213618.0,   -569925.0},
  { 0, 1, 0, 0,   -185116.0,     48888.0},
  { 0, 0, 0, 2,   -114332.0,     -3149.0},
  { 2, 0,-2, 0,     58793.0,    246158.0},
  { 2,-1,-1, 0,     57066.0,   -152138.0},
  { 2, 0, 1, 0,     53322.0,   -170733.0},
  { 2,-1, 0, 0,     45758.0,   -204586.0},
  { 0, 1,-1, 0,    -40923.0,   -129620.0},
  { 1, 0, 0, 0,    -34720.0,    108743.0},
  { 0, 1, 1, 0,    -30383.0,    104755.0},
  { 2, 0, 0,-2,     15327.0,     10321.0},
  { 0, 0, 1, 2,    -12528.0,         0.0},
  { 0, 0, 1,-2,     10980.0,     79661.0},
  { 4, 0,-1, 0,     10675.0,    -34782.0},
  { 0, 0, 3, 0,     10034.0,    -23210.0},
  { 4, 0,-2, 0,      8548.0,    -21636.0},
  { 2, 1,-1, 0,     -7888.0,     24208.0},
  { 2, 1, 0, 0,     -6766.0,     30824.0},
  { 1, 0,-1, 0,     -5163.0,     -8379.0},
  { 1, 1, 0, 0,      4987.0,    -16675.0},
  { 2,-1, 1, 0,      4036.0,    -12831.0},
  { 2, 0, 2, 0,      3994.0,    -10445.0},
  { 4, 0, 0, 0,      3861.0,    -11650.0},
  { 2, 0,-3, 0,      3665.0,     14403.0},
  { 0, 1,-2, 0,     -2689.0,     -7003.0},
  { 2, 0,-1, 2,     -2602.0,         0.0},
  { 2,-1,-2, 0,      2390.0,     10056.0},
  { 1, 0, 1, 0,     -2348.0,      6322.0},
  { 2,-2, 0, 0,      2236.0,     -9884.0},
  { 0, 1, 2, 0,     -2120.0,      5751.0},
  { 0, 2, 0, 0,     -2069.0,         0.0},
  { 2,-2,-1, 0,      2048.0,     -4950.0},
  { 2, 0, 1,-2,     -1773.0,      4130.0},
  { 2, 0, 0, 2,     -1595.0,         0.0},
  { 4,-1,-1, 0,      1215.0,     -3958.0},
  { 0, 0, 2, 2,     -1110.0,         0.0},
  { 3, 0,-1, 0,      -892.0,      3258.0},
  { 2, 1, 1, 0,      -810.0,      2616.0},
  { 4,-1,-2, 0,       759.0,     -1897.0},
  { 0, 2,-1, 0,      -713.0,     -2117.0},
  { 2, 2,-1, 0,      -700.0,      2354.0},
  { 2, 1,-2, 0,       691.0,         0.0},
  { 2,-1, 0,-2,       596.0,         0.0},
  { 4, 0, 1, 0,       549.0,     -1423.0},
  { 0, 0, 4, 0,       537.0,     -1117.0},
  { 4,-1, 0, 0,       520.0,     -1571.0},
  { 1, 0,-2, 0,      -487.0,     -1739.0},
  { 2, 1, 0,-2,      -399.0,         0.0},
  { 0, 0, 2,-2,      -381.0,     -4421.0},
  { 1, 1, 1, 0,       351.0,         0.0},
  { 3, 0,-2, 0,      -340.0,         0.0},
  { 4, 0,-3, 0,       330.0,         0.0},
  { 2,-1, 2, 0,       327.0,         0.0},
  { 0, 2, 1, 0,      -323.0,      1165.0},
  { 1, 1,-1, 0,       299.0,         0.0},
  { 2, 0, 3, 0,       294.0,         0.0},
  { 2, 0,-1,-2,         0.0,      8752.0}};

// Lunar b series
struct coeff_b {
  int nd,nm,nm1,nf;
  double sa;
} cb[]={
  { 0, 0, 0, 1,   5128122.0},
  { 0, 0, 1, 1,    280602.0},
  { 0, 0, 1,-1,    277693.0},
  { 2, 0, 0,-1,    173237.0},
  { 2, 0,-1, 1,     55413.0},
  { 2, 0,-1,-1,     46271.0},
  { 2, 0, 0, 1,     32573.0},
  { 0, 0, 2, 1,     17198.0},
  { 2, 0, 1,-1,      9266.0},
  { 0, 0, 2,-1,      8822.0},
  { 2,-1, 0,-1,      8216.0},
  { 2, 0,-2,-1,      4324.0},
  { 2, 0, 1, 1,      4200.0},
  { 2, 1, 0,-1,     -3359.0},
  { 2,-1,-1, 1,      2463.0},
  { 2,-1, 0, 1,      2211.0},
  { 2,-1,-1,-1,      2065.0},
  { 0, 1,-1,-1,     -1870.0},
  { 4, 0,-1,-1,      1828.0},
  { 0, 1, 0, 1,     -1794.0},
  { 0, 0, 0, 3,     -1749.0},
  { 0, 1,-1, 1,     -1565.0},
  { 1, 0, 0, 1,     -1491.0},
  { 0, 1, 1, 1,     -1475.0},
  { 0, 1, 1,-1,     -1410.0},
  { 0, 1, 0,-1,     -1344.0},
  { 1, 0, 0,-1,     -1335.0},
  { 0, 0, 3, 1,      1107.0},
  { 4, 0, 0,-1,      1021.0},
  { 4, 0,-1, 1,       833.0},
  { 0, 0, 1,-3,       777.0},
  { 4, 0,-2, 1,       671.0},
  { 2, 0, 0,-3,       607.0},
  { 2, 0, 2,-1,       596.0},
  { 2,-1, 1,-1,       491.0},
  { 2, 0,-2, 1,      -451.0},
  { 0, 0, 3,-1,       439.0},
  { 2, 0, 2, 1,       422.0},
  { 2, 0,-3,-1,       421.0},
  { 2, 1,-1, 1,      -366.0},
  { 2, 1, 0, 1,      -351.0},
  { 4, 0, 0, 1,       331.0},
  { 2,-1, 1, 1,       315.0},
  { 2,-2, 0,-1,       302.0},
  { 0, 0, 1, 3,      -283.0},
  { 2, 1, 1,-1,      -229.0},
  { 1, 1, 0,-1,       223.0},
  { 1, 1, 0, 1,       223.0},
  { 0, 1,-2,-1,      -220.0},
  { 2, 1,-1,-1,      -220.0},
  { 1, 0, 1, 1,      -185.0},
  { 2,-1,-2,-1,       181.0},
  { 0, 1, 2, 1,      -177.0},
  { 4, 0,-2,-1,       176.0},
  { 4,-1,-1,-1,       166.0},
  { 1, 0, 1,-1,      -164.0},
  { 4, 0, 1,-1,       132.0},
  { 1, 0,-1,-1,      -119.0},
  { 4,-1, 0,-1,       115.0},
  { 2,-2, 0, 1,       107.0}};

// Nutation series
static const struct {
  int nm1,nm,nf,nd,nn;
  double s,st;
  double c,ct;
} nut[]={
  {  0,  0,  0,  0,  1, -171996.0, -174.2,  92025.0,    8.9 },
  {  0,  0,  0,  0,  2,    2062.0,    0.2,   -895.0,    0.5 },
  { -2,  0,  2,  0,  1,      46.0,    0.0,    -24.0,    0.0 },
  {  2,  0, -2,  0,  0,      11.0,    0.0,      0.0,    0.0 },
  { -2,  0,  2,  0,  2,      -3.0,    0.0,      1.0,    0.0 },
  {  1, -1,  0, -1,  0,      -3.0,    0.0,      0.0,    0.0 },
  {  0, -2,  2, -2,  1,      -2.0,    0.0,      1.0,    0.0 },
  {  2,  0, -2,  0,  1,       1.0,    0.0,      0.0,    0.0 },
  {  0,  0,  2, -2,  2,  -13187.0,   -1.6,   5736.0,   -3.1 },
  {  0,  1,  0,  0,  0,    1426.0,   -3.4,     54.0,   -0.1 },
  {  0,  1,  2, -2,  2,    -517.0,    1.2,    224.0,   -0.6 },
  {  0, -1,  2, -2,  2,     217.0,   -0.5,    -95.0,    0.3 },
  {  0,  0,  2, -2,  1,     129.0,    0.1,    -70.0,    0.0 },
  {  2,  0,  0, -2,  0,      48.0,    0.0,      1.0,    0.0 },
  {  0,  0,  2, -2,  0,     -22.0,    0.0,      0.0,    0.0 },
  {  0,  2,  0,  0,  0,      17.0,   -0.1,      0.0,    0.0 },
  {  0,  1,  0,  0,  1,     -15.0,    0.0,      9.0,    0.0 },
  {  0,  2,  2, -2,  2,     -16.0,    0.1,      7.0,    0.0 },
  {  0, -1,  0,  0,  1,     -12.0,    0.0,      6.0,    0.0 },
  { -2,  0,  0,  2,  1,      -6.0,    0.0,      3.0,    0.0 },
  {  0, -1,  2, -2,  1,      -5.0,    0.0,      3.0,    0.0 },
  {  2,  0,  0, -2,  1,       4.0,    0.0,     -2.0,    0.0 },
  {  0,  1,  2, -2,  1,       4.0,    0.0,     -2.0,    0.0 },
  {  1,  0,  0, -1,  0,      -4.0,    0.0,      0.0,    0.0 },
  {  2,  1,  0, -2,  0,       1.0,    0.0,      0.0,    0.0 },
  {  0,  0, -2,  2,  1,       1.0,    0.0,      0.0,    0.0 },
  {  0,  1, -2,  2,  0,      -1.0,    0.0,      0.0,    0.0 },
  {  0,  1,  0,  0,  2,       1.0,    0.0,      0.0,    0.0 },
  { -1,  0,  0,  1,  1,       1.0,    0.0,      0.0,    0.0 },
  {  0,  1,  2, -2,  0,      -1.0,    0.0,      0.0,    0.0 },
  {  0,  0,  2,  0,  2,   -2274.0,   -0.2,    977.0,   -0.5 },
  {  1,  0,  0,  0,  0,     712.0,    0.1,     -7.0,    0.0 },
  {  0,  0,  2,  0,  1,    -386.0,   -0.4,    200.0,    0.0 },
  {  1,  0,  2,  0,  2,    -301.0,    0.0,    129.0,   -0.1 },
  {  1,  0,  0, -2,  0,    -158.0,    0.0,     -1.0,    0.0 },
  { -1,  0,  2,  0,  2,     123.0,    0.0,    -53.0,    0.0 },
  {  0,  0,  0,  2,  0,      63.0,    0.0,     -2.0,    0.0 },
  {  1,  0,  0,  0,  1,      63.0,    0.1,    -33.0,    0.0 },
  { -1,  0,  0,  0,  1,     -58.0,   -0.1,     32.0,    0.0 },
  { -1,  0,  2,  2,  2,     -59.0,    0.0,     26.0,    0.0 },
  {  1,  0,  2,  0,  1,     -51.0,    0.0,     27.0,    0.0 },
  {  0,  0,  2,  2,  2,     -38.0,    0.0,     16.0,    0.0 },
  {  2,  0,  0,  0,  0,      29.0,    0.0,     -1.0,    0.0 },
  {  1,  0,  2, -2,  2,      29.0,    0.0,    -12.0,    0.0 },
  {  2,  0,  2,  0,  2,     -31.0,    0.0,     13.0,    0.0 },
  {  0,  0,  2,  0,  0,      26.0,    0.0,     -1.0,    0.0 },
  { -1,  0,  2,  0,  1,      21.0,    0.0,    -10.0,    0.0 },
  { -1,  0,  0,  2,  1,      16.0,    0.0,     -8.0,    0.0 },
  {  1,  0,  0, -2,  1,     -13.0,    0.0,      7.0,    0.0 },
  { -1,  0,  2,  2,  1,     -10.0,    0.0,      5.0,    0.0 },
  {  1,  1,  0, -2,  0,      -7.0,    0.0,      0.0,    0.0 },
  {  0,  1,  2,  0,  2,       7.0,    0.0,     -3.0,    0.0 },
  {  0, -1,  2,  0,  2,      -7.0,    0.0,      3.0,    0.0 },
  {  1,  0,  2,  2,  2,      -8.0,    0.0,      3.0,    0.0 },
  {  1,  0,  0,  2,  0,       6.0,    0.0,      0.0,    0.0 },
  {  2,  0,  2, -2,  2,       6.0,    0.0,     -3.0,    0.0 },
  {  0,  0,  0,  2,  1,      -6.0,    0.0,      3.0,    0.0 },
  {  0,  0,  2,  2,  1,      -7.0,    0.0,      3.0,    0.0 },
  {  1,  0,  2, -2,  1,       6.0,    0.0,     -3.0,    0.0 },
  {  0,  0,  0, -2,  1,      -5.0,    0.0,      3.0,    0.0 },
  {  1, -1,  0,  0,  0,       5.0,    0.0,      0.0,    0.0 },
  {  2,  0,  2,  0,  1,      -5.0,    0.0,      3.0,    0.0 },
  {  0,  1,  0, -2,  0,      -4.0,    0.0,      0.0,    0.0 },
  {  1,  0, -2,  0,  0,       4.0,    0.0,      0.0,    0.0 },
  {  0,  0,  0,  1,  0,      -4.0,    0.0,      0.0,    0.0 },
  {  1,  1,  0,  0,  0,      -3.0,    0.0,      0.0,    0.0 },
  {  1,  0,  2,  0,  0,       3.0,    0.0,      0.0,    0.0 },
  {  1, -1,  2,  0,  2,      -3.0,    0.0,      1.0,    0.0 },
  { -1, -1,  2,  2,  2,      -3.0,    0.0,      1.0,    0.0 },
  { -2,  0,  0,  0,  1,      -2.0,    0.0,      1.0,    0.0 },
  {  3,  0,  2,  0,  2,      -3.0,    0.0,      1.0,    0.0 },
  {  0, -1,  2,  2,  2,      -3.0,    0.0,      1.0,    0.0 },
  {  1,  1,  2,  0,  2,       2.0,    0.0,     -1.0,    0.0 },
  { -1,  0,  2, -2,  1,      -2.0,    0.0,      1.0,    0.0 },
  {  2,  0,  0,  0,  1,       2.0,    0.0,     -1.0,    0.0 },
  {  1,  0,  0,  0,  2,      -2.0,    0.0,      1.0,    0.0 },
  {  3,  0,  0,  0,  0,       2.0,    0.0,      0.0,    0.0 },
  {  0,  0,  2,  1,  2,       2.0,    0.0,     -1.0,    0.0 },
  { -1,  0,  0,  0,  2,       1.0,    0.0,     -1.0,    0.0 },
  {  1,  0,  0, -4,  0,      -1.0,    0.0,      0.0,    0.0 },
  { -2,  0,  2,  2,  2,       1.0,    0.0,     -1.0,    0.0 },
  { -1,  0,  2,  4,  2,      -2.0,    0.0,      1.0,    0.0 },
  {  2,  0,  0, -4,  0,      -1.0,    0.0,      0.0,    0.0 },
  {  1,  1,  2, -2,  2,       1.0,    0.0,     -1.0,    0.0 },
  {  1,  0,  2,  2,  1,      -1.0,    0.0,      1.0,    0.0 },
  { -2,  0,  2,  4,  2,      -1.0,    0.0,      1.0,    0.0 },
  { -1,  0,  4,  0,  2,       1.0,    0.0,      0.0,    0.0 },
  {  1, -1,  0, -2,  0,       1.0,    0.0,      0.0,    0.0 },
  {  2,  0,  2, -2,  1,       1.0,    0.0,     -1.0,    0.0 },
  {  2,  0,  2,  2,  2,      -1.0,    0.0,      0.0,    0.0 },
  {  1,  0,  0,  2,  1,      -1.0,    0.0,      0.0,    0.0 },
  {  0,  0,  4, -2,  2,       1.0,    0.0,      0.0,    0.0 },
  {  3,  0,  2, -2,  2,       1.0,    0.0,      0.0,    0.0 },
  {  1,  0,  2, -2,  0,      -1.0,    0.0,      0.0,    0.0 },
  {  0,  1,  2,  0,  1,       1.0,    0.0,      0.0,    0.0 },
  { -1, -1,  0,  2,  1,       1.0,    0.0,      0.0,    0.0 },
  {  0,  0, -2,  0,  1,      -1.0,    0.0,      0.0,    0.0 },
  {  0,  0,  2, -1,  2,      -1.0,    0.0,      0.0,    0.0 },
  {  0,  1,  0,  2,  0,      -1.0,    0.0,      0.0,    0.0 },
  {  1,  0, -2, -2,  0,      -1.0,    0.0,      0.0,    0.0 },
  {  0, -1,  2,  0,  1,      -1.0,    0.0,      0.0,    0.0 },
  {  1,  1,  0, -2,  1,      -1.0,    0.0,      0.0,    0.0 },
  {  1,  0, -2,  2,  0,      -1.0,    0.0,      0.0,    0.0 },
  {  2,  0,  0,  2,  0,       1.0,    0.0,      0.0,    0.0 },
  {  0,  0,  2,  4,  2,      -1.0,    0.0,      0.0,    0.0 },
  {  0,  1,  0,  1,  0,       1.0,    0.0,      0.0,    0.0 }
};

